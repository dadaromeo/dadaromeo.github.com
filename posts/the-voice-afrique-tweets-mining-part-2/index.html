<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Voice Afrique Tweets Mining Part 2 | Adventures in Dataland</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://dadaromeo.github.io/posts/the-voice-afrique-tweets-mining-part-2/">
<link rel="icon" href="../../favicon.ico" sizes="16x16">
<link rel="icon" href="../../favicon-16x16.png" sizes="16x16">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Dada Romeo">
<link rel="prev" href="../the-voice-afrique-tweets-mining-part-1/" title="The Voice Afrique Tweets Mining Part 1" type="text/html">
<link rel="next" href="../the-voice-afrique-tweets-mining-part-3/" title="The Voice Afrique Tweets Mining Part 3" type="text/html">
<meta property="og:site_name" content="Adventures in Dataland">
<meta property="og:title" content="The Voice Afrique Tweets Mining Part 2">
<meta property="og:url" content="https://dadaromeo.github.io/posts/the-voice-afrique-tweets-mining-part-2/">
<meta property="og:description" content="In the previous post,
we showed how to use Twitter API and the excellent Tweepy Python library to collect
data and store them in a MongoDB database.
It's now time to start aking questions.
Many of the">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-11-08T14:08:00+01:00">
<meta property="article:tag" content="graph-tool">
<meta property="article:tag" content="social network analysis">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@dadaromeo">
<meta name="twitter:creator" content="@dadaromeo">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
</head>
<body>


<!-- BODY CONTAINER -->
<div class="container" id="body_container">

    <!-- HEADER -->
    <header id="body_header"><a href="../../"><img class="portrait" src="../../assets/img/portrait-64x64.jpg"></a><br><em>Adventures in Dataland</em>
    </header><!-- NAVBAR --><nav class="navbar navbar-default navbar-static"><div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>
                
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false" role="navigation">
            <ul class="nav navbar-nav">
<li>
<a href="../../">Home</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
    </nav><!-- BODY CONTENT !! --><div class="container" id="body_content" role="main">

        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><!--<h1 class="p-name entry-title" itemprop="headline name"><a href="/posts/the-voice-afrique-tweets-mining-part-2/" class="u-url">The Voice Afrique Tweets Mining Part 2</a></h1> --><h1 class="p-name entry-title" itemprop="headline name">The Voice Afrique Tweets Mining Part 2</h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    Dada Romeo
            </span></p>
            <p class="dateline"><time class="published dt-published" datetime="2016-11-08T14:08:00+01:00" itemprop="datePublished" title="2016-11-08 14:08">2016-11-08 14:08</time></p>
                <p class="commentline">            <a href="#disqus_thread" data-disqus-identifier="cache/posts/the-voice-afrique-tweets-mining-part-2.html">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>In the <a class="reference external" href="../the-voice-afrique-tweets-mining-part-1/">previous post</a>,
we showed how to use Twitter API and the excellent Tweepy Python library to collect
data and store them in a <a class="reference external" href="https://www.mongodb.com/">MongoDB</a> database.
It's now time to start aking questions.</p>
<p>Many of the questions that we ask of our tweets data can be answered through
<a class="reference external" href="https://en.wikipedia.org/wiki/Social_network_analysis">social network analysis</a>.
Questions such as <em>who is important?</em>, <em>who talks to whom?</em>, and <em>what is important?</em>
can all be answered through a network. Using proper network measures, we can find
these important actors or topics in a network.</p>
<!-- TEASER_END -->
<p>A network (or graph) is a set of <em>vertices</em> linked by a set of <em>edges</em>.
Vertices are the elements that comprise a network and edges join vertices.
Undirected edges join vertices in a symmetric fashion. If two people engage in a
conversation, then this is best represented by an undirected edge because for user
<code>Alice</code> to converse with user <code>Bob</code>, <code>Bob</code> must also converse with <code>Alice</code>.</p>
<p>Contrary to undirected edges are directed edges, which signify a one-way relationship
between two users. <code>Alice</code> retweet relationship can be thought of as a directed
edge because <code>Alice</code> can retweet <code>Bob</code> without <code>Bob</code> reciprocating.</p>
<p>Another property to consider is <em>edge weight</em>. The weight of an edge signifies its
importance when compared to other edges. One natural usage of weighted edges is in
a user mention network, where the weight is the number of times the a user say
<code>Alice</code> mentions another user, <code>Bob</code>.</p>
<div class="section" id="networks-from-tweets-data">
<h2>Networks from tweets data</h2>
<p>We begin by constructing a retweet network because it carries a very intuitive meaning.
The nodes are individual users. The <em>directed</em> edges indicate the flow of information in the network.
An edge from node <span class="math">\(A\)</span> to node <span class="math">\(B\)</span> indicates that <span class="math">\(A\)</span> has retweeted <span class="math">\(B\)</span>, forwarding <span class="math">\(B\)</span>’s
information to his followers. Studying the structure of this network yields information
about the ways the users communicate, and how highly they value each others’ information.</p>
<p>We use <a class="reference external" href="https://graph-tool.skewed.de/">Graph-tool</a>, an efficient Python module
for manipulation and statistical analysis of graphs.</p>
<pre class="code python"><a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-1"></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-2"></a>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-4"></a><span class="kn">import</span> <span class="nn">graph_tool.all</span> <span class="kn">as</span> <span class="nn">gt</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-5"></a><span class="kn">import</span> <span class="nn">pymongo</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-6"></a>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-7"></a><span class="n">host</span> <span class="o">=</span> <span class="s2">"localhost"</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-8"></a><span class="n">port</span> <span class="o">=</span> <span class="mi">27017</span>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-9"></a>
<a name="rest_code_ed6742fd23564bd9bb825d87fdf79b7f-10"></a><span class="n">db</span> <span class="o">=</span> <span class="n">pymongo</span><span class="o">.</span><span class="n">MongoClient</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span><span class="o">.</span><span class="n">search</span>
</pre>
<p>The <code>create_network</code> function will help us create different kind of networks (retweet,
mention, hashtag coccurence) during this analysis. It takes a set of vertices and
edges and a keyword indicating the type (directed, undirected) of network.</p>
<pre class="code python"><a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-1"></a><span class="n">font_family</span> <span class="o">=</span> <span class="s2">"Lato Medium"</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-2"></a><span class="n">output_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-3"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-4"></a><span class="k">def</span> <span class="nf">create_network</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-5"></a>    <span class="n">net</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-6"></a>    <span class="n">label</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">"string"</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-7"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-8"></a>    <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-9"></a>    <span class="n">net</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">))</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-10"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-11"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">vertices</span><span class="p">()):</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-12"></a>        <span class="n">label</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-13"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-14"></a>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-15"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-16"></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">label</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-17"></a>            <span class="k">if</span> <span class="n">edges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-18"></a>                <span class="n">net</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-19"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-20"></a>    <span class="n">net</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s2">"label"</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-21"></a>    <span class="n">gt</span><span class="o">.</span><span class="n">remove_self_loops</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-22"></a>    <span class="k">return</span> <span class="n">net</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-23"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-24"></a><span class="k">def</span> <span class="nf">weight_from</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-25"></a>    <span class="n">weight</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">"float"</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-26"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-27"></a>    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-28"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-29"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-30"></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-31"></a>        <span class="n">weight</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-32"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-33"></a>    <span class="k">return</span> <span class="n">weight</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-34"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-35"></a><span class="k">def</span> <span class="nf">pprint</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">"simple"</span><span class="p">):</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-36"></a>    <span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-37"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-38"></a>    <span class="n">most</span> <span class="o">=</span> <span class="p">{}</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-39"></a>    <span class="n">label</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s2">"label"</span><span class="p">]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-40"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-41"></a>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">retweet_net</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-42"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">metric</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-43"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-44"></a>        <span class="n">most</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-45"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-46"></a>    <span class="n">users</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">most</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">most</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-47"></a>    <span class="n">top</span> <span class="o">=</span> <span class="p">{</span><span class="s2">""</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="p">:</span> <span class="n">users</span><span class="p">}</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-48"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-49"></a>    <span class="n">tabular</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-50"></a>
<a name="rest_code_c7d0b6a689524d1aa5406e1cffb759ed-51"></a>    <span class="k">print</span><span class="p">(</span><span class="n">tabular</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="retweet-network">
<h2>Retweet network</h2>
<pre class="code python"><a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-1"></a><span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-2"></a><span class="n">edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-3"></a>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-4"></a><span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">thevoice</span><span class="o">.</span><span class="n">find</span><span class="p">():</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-5"></a>    <span class="k">if</span> <span class="s2">"retweeted_status"</span> <span class="ow">in</span> <span class="n">tweet</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-6"></a>        <span class="n">s</span> <span class="o">=</span> <span class="s2">"@"</span> <span class="o">+</span> <span class="n">tweet</span><span class="p">[</span><span class="s2">"user"</span><span class="p">][</span><span class="s2">"screen_name"</span><span class="p">]</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-7"></a>        <span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-8"></a>        <span class="n">t</span> <span class="o">=</span> <span class="s2">"@"</span> <span class="o">+</span> <span class="n">tweet</span><span class="p">[</span><span class="s2">"retweeted_status"</span><span class="p">][</span><span class="s2">"user"</span><span class="p">][</span><span class="s2">"screen_name"</span><span class="p">]</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-9"></a>        <span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-10"></a>        <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-11"></a>        <span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-12"></a>
<a name="rest_code_d82acb16890a4cbeb1119d7160ecd518-13"></a><span class="n">retweet_net</span> <span class="o">=</span> <span class="n">create_network</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
</pre>
<div class="section" id="centrality">
<h3>Centrality</h3>
<p>Often, we want to know who is the most important person in the network. The question
of importance may not be as straightforward as it seems. There are several dimensions
along which one may be considered important. Measures of importance in social networks
are called <em>centrality measures</em>. Three (<em>degree centrality</em>, <em>eigenvector centrality</em>
and <em>betweeness centrality</em>) of these measures are the most frequently used in social
media analysis. Here, we discuss the first two of them. Each provides a different view
of who is important in the network. We will use the retweet network for the purpose.</p>
<div class="section" id="in-degree-centrality-who-is-the-most-retweeted">
<h4>In degree centrality - Who is the most retweeted?</h4>
<p>One of the most commonly used centrality measures is <em>degree centrality</em>. The calculation
is simple: count the number of links attached to the node, this is their degree centrality.
In the case of a directed graph, there are two interpretations: <em>In-Degree Centrality</em>, the
number of edges entering the node, and <em>Out-Degree</em>, the number of edges leaving the
node. In the context of our retweet networks, <em>In-Degree Centrality</em> is the number of users
that retweet the node, and <em>Out-Degree Centrality</em> is the number of users the node retweets.
The figure below shows such a network with our tweets data.</p>
<pre class="code python"><a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-1"></a><span class="n">deg</span> <span class="o">=</span> <span class="n">retweet_net</span><span class="o">.</span><span class="n">degree_property_map</span><span class="p">(</span><span class="s2">"in"</span><span class="p">)</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-2"></a><span class="n">label</span> <span class="o">=</span> <span class="n">retweet_net</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s2">"label"</span><span class="p">]</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-3"></a>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-4"></a><span class="n">vsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-5"></a><span class="n">vfsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-6"></a>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-7"></a><span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">arf_layout</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">)</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-8"></a>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-9"></a><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-10"></a>          <span class="n">pos</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-11"></a>          <span class="n">vertex_size</span><span class="o">=</span><span class="n">vsize</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-12"></a>          <span class="n">vertex_text</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-13"></a>          <span class="n">vertex_font_size</span><span class="o">=</span><span class="n">vfsize</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-14"></a>          <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-15"></a>          <span class="n">vertex_font_family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-16"></a>          <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-17"></a>          <span class="n">output</span><span class="o">=</span><span class="s2">"images/retweet_net_in_centrality.png"</span><span class="p">,</span>
<a name="rest_code_b3edd7b172db47e6a9428e69e7dd1c36-18"></a>          <span class="p">)</span>
</pre>
<img alt="retweet network in-degree centrality" class="align-center" src="../../images/retweet_net_in_centrality.png"><pre class="code python"><a name="rest_code_dde612244d5e4662b2c19ec169228e0f-1"></a><span class="n">pprint</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="s2">"Most retweeted"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre>
<table border="1" class="docutils">
<colgroup>
<col width="15%">
<col width="85%">
</colgroup>
<thead valign="bottom"><tr>
<th class="head"> </th>
<th class="head">Most retweeted</th>
</tr></thead>
<tbody valign="top">
<tr>
<td>1</td>
<td>@thevoiceafrique</td>
</tr>
<tr>
<td>2</td>
<td>@Jojo_Le_Doc</td>
</tr>
<tr>
<td>3</td>
<td>@L_ebene</td>
</tr>
<tr>
<td>4</td>
<td>@AnniePayep</td>
</tr>
<tr>
<td>5</td>
<td>@_Coriet_</td>
</tr>
<tr>
<td>6</td>
<td>@Fantastyck</td>
</tr>
<tr>
<td>7</td>
<td>@asalfomagic</td>
</tr>
<tr>
<td>8</td>
<td>@Ton_durex</td>
</tr>
<tr>
<td>9</td>
<td>@Arn8ld</td>
</tr>
<tr>
<td>10</td>
<td>@Hermine_N</td>
</tr>
</tbody>
</table>
<p>We see on the figure and the table above, without a surprise that the official
page of the event, <code>@thevoiceafrique</code> is the most retweeted. We also see that one the
coaches, <cite>@asalfomagic</cite> is retweeted a lot. In the <a class="reference external" href="../the-voice-afrique-tweets-mining-part-3/">topic modeling</a>
and <a class="reference external" href="../the-voice-afrique-tweets-mining-part-4/">sentiment analysis</a>
post, we will see if we can tell more about that.</p>
</div>
<div class="section" id="egeinvector-centrality-who-is-the-most-influencial">
<h4>Egeinvector centrality - Who is the most influencial?</h4>
<p>With Degree Centrality the key question was "how many people retweeted this node?"
<em>Eigenvector Centrality</em> builds upon this to ask "how important are these retweeters?"</p>
<pre class="code python"><a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-1"></a><span class="n">eig</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">eigenvector</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-2"></a><span class="n">label</span> <span class="o">=</span> <span class="n">retweet_net</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s2">"label"</span><span class="p">]</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-3"></a>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-4"></a><span class="n">vsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">eig</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-5"></a><span class="n">vfsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">eig</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-6"></a>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-7"></a><span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">arf_layout</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">)</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-8"></a>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-9"></a><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">retweet_net</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-10"></a>          <span class="n">pos</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-11"></a>          <span class="n">vertex_size</span><span class="o">=</span><span class="n">vsize</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-12"></a>          <span class="n">vertex_text</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-13"></a>          <span class="n">vertex_font_size</span><span class="o">=</span><span class="n">vfsize</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-14"></a>          <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">eig</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-15"></a>          <span class="n">vertex_font_family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-16"></a>          <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-17"></a>          <span class="n">output</span><span class="o">=</span><span class="s2">"images/retweet_net_eig_centrality.png"</span><span class="p">,</span>
<a name="rest_code_336494a5bf9d4580b7f6f4b385a622ee-18"></a>          <span class="p">)</span>
</pre>
<img alt="retweet network eigenvalue centrality" class="align-center" src="../../images/retweet_net_eig_centality.png"><pre class="code python"><a name="rest_code_65ffd126a9134a85b39b432eb864d8fe-1"></a><span class="n">pprint</span><span class="p">(</span><span class="n">retweet_net</span> <span class="n">eig</span><span class="p">,</span> <span class="s2">"Most influencial"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre>
<table border="1" class="docutils">
<colgroup>
<col width="15%">
<col width="85%">
</colgroup>
<thead valign="bottom"><tr>
<th class="head"> </th>
<th class="head">Most influencial</th>
</tr></thead>
<tbody valign="top">
<tr>
<td>1</td>
<td>@thevoiceafrique</td>
</tr>
<tr>
<td>2</td>
<td>@Jojo_Le_Doc</td>
</tr>
<tr>
<td>3</td>
<td>@DianeDomkam</td>
</tr>
<tr>
<td>4</td>
<td>@AnniePayep</td>
</tr>
<tr>
<td>5</td>
<td>@Ton_durex</td>
</tr>
<tr>
<td>6</td>
<td>@tvmvondoarts</td>
</tr>
<tr>
<td>7</td>
<td>@Fantastyck</td>
</tr>
<tr>
<td>8</td>
<td>@Tinette_A</td>
</tr>
<tr>
<td>9</td>
<td>@NadiaKimberley</td>
</tr>
<tr>
<td>10</td>
<td>@jussoch</td>
</tr>
</tbody>
</table>
<p>We see in the figure and the table above that the strucutre of the network and the
ranking have changed. Some users kept thier position, other downweighted, and other
upweighted. We see that there are new "players" in the ranking table while others who where previously in the degree centrality table, went away,
like <code>@L_ebene</code> and <code>@_Coriet_</code>.</p>
</div>
</div>
</div>
<div class="section" id="mentions-network">
<h2>Mentions network</h2>
<p>In the mention network the edges are weighted to answer the question who mentions who the most?</p>
<pre class="code python"><a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-1"></a><span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-2"></a><span class="n">edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-3"></a>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-4"></a><span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">thevoice</span><span class="o">.</span><span class="n">find</span><span class="p">():</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-5"></a>    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="s2">"retweeted_status"</span> <span class="ow">in</span> <span class="n">tweet</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-6"></a>        <span class="n">mentions</span> <span class="o">=</span> <span class="n">tweet</span><span class="p">[</span><span class="s2">"entities"</span><span class="p">][</span><span class="s2">"user_mentions"</span><span class="p">]</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-7"></a>        <span class="k">if</span> <span class="n">mentions</span><span class="p">:</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-8"></a>            <span class="n">s</span> <span class="o">=</span> <span class="s2">"@"</span> <span class="o">+</span> <span class="n">tweet</span><span class="p">[</span><span class="s2">"user"</span><span class="p">][</span><span class="s2">"screen_name"</span><span class="p">]</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-9"></a>            <span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-10"></a>            <span class="k">for</span> <span class="n">ment</span> <span class="ow">in</span> <span class="n">mentions</span><span class="p">:</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-11"></a>                <span class="n">t</span> <span class="o">=</span> <span class="s2">"@"</span> <span class="o">+</span> <span class="n">ment</span><span class="p">[</span><span class="s2">"screen_name"</span><span class="p">]</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-12"></a>                <span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-13"></a>                <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-14"></a>                <span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-15"></a>
<a name="rest_code_afa862a7cec84d918c1e4ad7edeb7bcf-16"></a><span class="n">mention_net</span> <span class="o">=</span> <span class="n">create_network</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
</pre>
<p>With that,</p>
<pre class="code python"><a name="rest_code_421676ca107542ff85cb237947bd2162-1"></a><span class="n">mention_net</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">GraphView</span><span class="p">(</span><span class="n">mention_net</span><span class="p">,</span> <span class="n">vfilt</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="ow">not</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-2"></a>
<a name="rest_code_421676ca107542ff85cb237947bd2162-3"></a><span class="n">vbet</span><span class="p">,</span> <span class="n">ebet</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">betweenness</span><span class="p">(</span><span class="n">mention_net</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-4"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mention_net</span><span class="o">.</span><span class="n">vertex_properties</span><span class="p">[</span><span class="s2">"label"</span><span class="p">]</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-5"></a><span class="n">deg</span> <span class="o">=</span> <span class="n">mention_net</span><span class="o">.</span><span class="n">degree_property_map</span><span class="p">(</span><span class="s2">"in"</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-6"></a>
<a name="rest_code_421676ca107542ff85cb237947bd2162-7"></a><span class="n">vsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-8"></a><span class="n">vfsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-9"></a>
<a name="rest_code_421676ca107542ff85cb237947bd2162-10"></a><span class="n">weight</span> <span class="o">=</span> <span class="n">weight_from</span><span class="p">(</span><span class="n">mention_net</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-11"></a>
<a name="rest_code_421676ca107542ff85cb237947bd2162-12"></a><span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">arf_layout</span><span class="p">(</span><span class="n">mention_net</span><span class="p">)</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-13"></a>
<a name="rest_code_421676ca107542ff85cb237947bd2162-14"></a><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">mention_net</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-15"></a>          <span class="n">pos</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-16"></a>          <span class="n">vertex_size</span><span class="o">=</span><span class="n">vsize</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-17"></a>          <span class="n">vertex_text</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-18"></a>          <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">vbet</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-19"></a>          <span class="n">vertex_font_size</span><span class="o">=</span><span class="n">vfsize</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-20"></a>          <span class="n">vertex_font_family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-21"></a>          <span class="n">edge_pen_width</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-22"></a>          <span class="n">edge_color</span><span class="o">=</span><span class="n">ebet</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-23"></a>          <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-24"></a>          <span class="n">vorder</span><span class="o">=</span><span class="n">vbet</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-25"></a>          <span class="n">output</span><span class="o">=</span><span class="s2">"images/mention_net.png"</span><span class="p">,</span>
<a name="rest_code_421676ca107542ff85cb237947bd2162-26"></a>          <span class="p">)</span>
</pre>
<img alt="mention network" class="align-center" src="../../images/mention_net.png"><pre class="code python"><a name="rest_code_3d1abcf8afd341ad883eed34ab76a78b-1"></a><span class="n">pprint</span><span class="p">(</span><span class="n">mention_net</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="s2">"Most mentioned"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre>
<table border="1" class="docutils">
<colgroup>
<col width="15%">
<col width="85%">
</colgroup>
<thead valign="bottom"><tr>
<th class="head"> </th>
<th class="head">Most influencial</th>
</tr></thead>
<tbody valign="top">
<tr>
<td>1</td>
<td>@voxafrica</td>
</tr>
<tr>
<td>2</td>
<td>@thevoiceafrique</td>
</tr>
<tr>
<td>3</td>
<td>@Claudy_Siar</td>
</tr>
<tr>
<td>4</td>
<td>@asalfomagic</td>
</tr>
<tr>
<td>5</td>
<td>@SingulaMusic</td>
</tr>
<tr>
<td>6</td>
<td>@CharlotteDPA</td>
</tr>
<tr>
<td>7</td>
<td>@lockofficial</td>
</tr>
<tr>
<td>8</td>
<td>@AnniePayep</td>
</tr>
<tr>
<td>9</td>
<td>@Youtube</td>
</tr>
<tr>
<td>10</td>
<td>@PatrickEdooard</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hashtags-coccurence-network">
<h2>Hashtags coccurence network</h2>
<p>All of our network constructions so far have only considered users as nodes and
edges as retweets or mentions. We can choose any object as a node and any relation
as an edge. Let’s take a look at another network construction that allows us to ask
different questions about our tweets data.</p>
<p>What if we wanted to see how hashtags are related? There are many valid ways to
measure this, but, in this post, we will measure this using a network-based approach.
We will consider a new network construction where nodes are individual hashtags and
edges are hashtags that co-occur within the same Tweet. We will <em>weight</em> the edges
by the number of times the hashtags co-occur in a Tweet. Because we do not care about
the hashtag order, the edges are not directed.</p>
<pre class="code python"><a name="rest_code_4052cd1782b447189b3bd70704d84e14-1"></a><span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-2"></a><span class="n">edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-3"></a>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-4"></a><span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">thevoice</span><span class="o">.</span><span class="n">find</span><span class="p">():</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-5"></a>    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="s2">"retweeted_status"</span> <span class="ow">in</span> <span class="n">tweet</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-6"></a>        <span class="n">tags</span> <span class="o">=</span> <span class="n">tweet</span><span class="p">[</span><span class="s2">"entities"</span><span class="p">][</span><span class="s2">"hashtags"</span><span class="p">]</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-7"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-8"></a>            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-9"></a>                <span class="n">s</span> <span class="o">=</span> <span class="s2">"#"</span> <span class="o">+</span> <span class="n">tag</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-10"></a>            <span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-11"></a>                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-12"></a>                    <span class="n">t</span> <span class="o">=</span> <span class="s2">"#"</span> <span class="o">+</span> <span class="n">tag</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-13"></a>                    <span class="n">edges</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-14"></a>
<a name="rest_code_4052cd1782b447189b3bd70704d84e14-15"></a><span class="n">hashtag_net</span> <span class="o">=</span> <span class="n">create_network</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre>
<p>The edge construction in the retweet an mention network was not a problem because
we where building a directed network where edges can be bidirectional. Then, something
like this <code>{("Alice", "Bob"), ("Bob", "Alice")}</code> is allowed. Meaning <code>Alice</code>
mentioned <code>Bob</code> and <code>Bob</code> also mentiones <code>Alice</code>. In the undirected case,
these two egdes are the same and then add redundant information in the network.
We need to remove those parallel edges.</p>
<pre class="code python"><a name="rest_code_1695f71b42c84297a2766407796d316f-1"></a><span class="n">gt</span><span class="o">.</span><span class="n">remove_parallel_edges</span><span class="p">(</span><span class="n">hashtag_net</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-2"></a><span class="n">kcore</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">kcore_decomposition</span><span class="p">(</span><span class="n">hashtag_net</span><span class="p">,</span> <span class="s2">"total"</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-3"></a>
<a name="rest_code_1695f71b42c84297a2766407796d316f-4"></a><span class="n">vsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">kcore</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-5"></a><span class="n">vfsize</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">prop_to_size</span><span class="p">(</span><span class="n">kcore</span><span class="p">,</span> <span class="n">ma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-6"></a>
<a name="rest_code_1695f71b42c84297a2766407796d316f-7"></a><span class="n">weight</span> <span class="o">=</span> <span class="n">weight_from</span><span class="p">(</span><span class="n">hashtag_net</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-8"></a>
<a name="rest_code_1695f71b42c84297a2766407796d316f-9"></a><span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">sfdp_layout</span><span class="p">(</span><span class="n">hashtag_net</span><span class="p">,</span> <span class="n">vweight</span><span class="o">=</span><span class="n">kcore</span><span class="p">,</span> <span class="n">eweight</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-10"></a>
<a name="rest_code_1695f71b42c84297a2766407796d316f-11"></a><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">hashtag_net</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-12"></a>          <span class="n">pos</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-13"></a>          <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">kcore</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-14"></a>          <span class="n">vertex_font_family</span><span class="o">=</span><span class="n">font_family</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-15"></a>          <span class="n">vertex_font_size</span><span class="o">=</span><span class="n">vfsize</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-16"></a>          <span class="n">edge_color</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-17"></a>          <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">,</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-18"></a>          <span class="n">output</span><span class="o">=</span><span class="s2">"images/hashtag_net.png"</span>
<a name="rest_code_1695f71b42c84297a2766407796d316f-19"></a>         <span class="p">)</span>
</pre>
<img alt="hashtag network" class="align-center" src="../../images/hashtag_net.png"><p>That's all for this post. In the <a class="reference external" href="../the-voice-afrique-tweets-mining-part-3/">next</a>
post, we will explore <em>topic modeling</em> a powerful tool to uncover hidden within a corpus
of documents. Thanks for following.</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/graph-tool/" rel="tag">graph-tool</a></li>
            <li><a class="tag p-category" href="../../categories/social-network-analysis/" rel="tag">social network analysis</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../the-voice-afrique-tweets-mining-part-1/" rel="prev" title="The Voice Afrique Tweets Mining Part 1"><i class="fa fa-arrow-left"></i>  Previous post</a>
            </li>
            <li class="next">
                <a href="../the-voice-afrique-tweets-mining-part-3/" rel="next" title="The Voice Afrique Tweets Mining Part 3">Next post  <i class="fa fa-arrow-right"></i></a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="dadaromeo",
            disqus_url="https://dadaromeo.github.io/posts/the-voice-afrique-tweets-mining-part-2/",
        disqus_title="The Voice Afrique Tweets Mining Part 2",
        disqus_identifier="cache/posts/the-voice-afrique-tweets-mining-part-2.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="dadaromeo";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
</div>


<!-- BODY FOOTER -->
<div class="container">
    <footer id="body_footer">

        Contents © 2017         <a href="mailto:dada.romy@gmail.com">Dada Romeo</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
        


    </footer>
</div>


<!-- SCRIPTS -->
            <script src="../../assets/js/all-nocdn.js"></script><script>
    moment.locale("en");
    fancydates(1, "lll");
</script>
</body>
</html>
